"""
constants.py - 全局常量定义
版本: 2.4.3
日期: 2026-02-21
说明: 存放所有全局常量
"""

# =============================================================================
# 1. 按钮映射
# 说明: 押注按钮的 data 属性映射，键为金额，值为按钮 data
# =============================================================================

SMALL_BUTTON = {
    500: 14,
    2000: 12,
    20000: 10,
    50000: 8,
    250000: 6,
    1000000: 4,
    5000000: 2,
    50000000: 0
}

BIG_BUTTON = {
    500: 15,
    2000: 13,
    20000: 11,
    50000: 9,
    250000: 7,
    1000000: 5,
    5000000: 3,
    50000000: 1
}

# =============================================================================
# 2. 预设配置
# 说明: 内置押注策略预设 [continuous, lose_stop, lose_once, lose_twice, lose_three, lose_four, initial_amount]
# =============================================================================

PRESETS = {
    "yc05": ["1", "10", "2.8", "2.3", "2.2", "2.05", "500"],
    "yc1": ["1", "10", "2.8", "2.3", "2.2", "2.05", "1000"],
    "yc5": ["1", "10", "2.8", "2.3", "2.2", "2.05", "5000"],
    "yc10": ["1", "10", "2.8", "2.3", "2.2", "2.05", "10000"],
    "yc20": ["1", "10", "2.8", "2.3", "2.2", "2.05", "20000"],
    "yc30": ["1", "10", "2.8", "2.3", "2.2", "2.05", "30000"],
    "yc50": ["1", "10", "2.8", "2.3", "2.2", "2.05", "50000"],
    "yc100": ["1", "10", "2.8", "2.3", "2.2", "2.05", "100000"],
    "yc200": ["1", "10", "2.8", "2.3", "2.2", "2.05", "200000"]
}

# =============================================================================
# 3. 押注常量
# =============================================================================

BET_MULTIPLIER = 1.98
MAX_BET_AMOUNT = 500000
MIN_BET_AMOUNT = 500

AVAILABLE_AMOUNTS = [500, 2000, 20000, 50000, 250000, 1000000, 5000000, 50000000]

# =============================================================================
# 4. 历史记录限制
# =============================================================================

MAX_HISTORY_LENGTH = 5000
MAX_BET_LOG_LENGTH = 5000
MAX_PREDICTIONS_LENGTH = 2000

# =============================================================================
# 5. 默认模型配置
# =============================================================================

MODEL_DEFAULT_ID = "qwen3-coder-plus"

# =============================================================================
# 6. 辅助函数
# =============================================================================

def find_combination(target: int, buttons: dict = None) -> list:
    if buttons is None:
        buttons = BIG_BUTTON
    
    available_amounts = sorted(buttons.keys(), reverse=True)
    combination = []
    remaining = target
    
    for amount in available_amounts:
        while remaining >= amount:
            combination.append(amount)
            remaining -= amount
    
    return combination if remaining == 0 else []


def closest_multiple_of_500(n: int) -> int:
    return round(n / 500) * 500
